@page "/ViewPosts"
@using BlazorServer2.Data;
@using BlazorServer2.Models;
@using BlazorServer2.Pages.MiscComponents;
@using Microsoft.EntityFrameworkCore;
@inject ApplicationDbContext _context

<div class="container-fluid w-100">
    @if (BlogPosts == null)
    {
        <div class="w-100 d-flex flex-column justify-content-center align-items-center align-content-center text-center" style="height:50vh;">
            <h4>Loading Content...</h4>

            @* spinner from this site *@
            <?xml version="1.0" encoding="utf-8" ?>
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; background: url(); display: block; shape-rendering: auto;" width="200px" height="200px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">
                <circle cx="50" cy="50" r="32" stroke-width="8" stroke="#fe718d" stroke-dasharray="50.26548245743669 50.26548245743669" fill="none" stroke-linecap="round">
                    <animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" keyTimes="0;1" values="0 50 50;360 50 50"></animateTransform>
                </circle>
                <!-- [ldio] generated by https://loading.io/ -->
            </svg>
        </div>

    }
    else if (BlogPosts.Count == 0)
    {
        <p>There are no posts to display...</p>
    }
    else
    {
        foreach (BlogPost blogPost in BlogPosts)
        {
            <BlogPostDemoCreation BlogPostDemo="blogPost" />
        }
    }
</div>

@code {
    public List<BlogPost> BlogPosts { get; set; } = null;
    public string LoadingMessage { get; set; } = "Loading Posts";

    protected override async Task OnInitializedAsync()
    {
        BlogPosts = await _context.BlogPosts.ToListAsync();

        await base.OnInitializedAsync();
    }
}
